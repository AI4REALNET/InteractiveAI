variables:
  PIP_CACHE_DIR: "$CI_PROJECT_DIR/.cache/pip"
  COV_CONTEXT: "backend"

.pytest-coverage:
  stage: test
  image: python:3.11.4-slim
  interruptible: true
  artifacts:
    when: always
    reports:
      coverage_report:
        coverage_format: cobertura
        path: ${COV_CONTEXT}/coverage.xml
      junit: ${COV_CONTEXT}/report.xml
  rules:
    - if: $CI_COMMIT_BRANCH != "test-ci"
